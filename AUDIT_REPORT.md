# –ò—Ç–æ–≥–æ–≤—ã–π –∞—É–¥–∏—Ç –∏ —Å–ª–∏—è–Ω–∏–µ

## –í—Ö–æ–¥–Ω—ã–µ –≤–µ—Ä—Å–∏–∏

- **V1 (–î–æ–Ω–æ—Ä)**: PTB, SQLite, –ø—Ä–æ—Å—Ç–∞—è –æ—á–µ—Ä–µ–¥—å, –±–µ–∑ –∞–Ω—Ç–∏‚Äë—Ä–µ–º–∞—Ç—á–∞, –±–µ–∑ Docker/PG, GPL.

- **V2 (–°—Ç–∞—Ä—ã–π UI)**: aiogram 3.x; –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–Ω–æ–ø–∫–∏/—Ç–µ–∫—Å—Ç—ã; –±–µ–∑ –Ω–∞–¥—ë–∂–Ω–æ–≥–æ PG‚Äë–º—ç—Ç—á–∏–Ω–≥–∞.

- **V3 (–ù–æ–≤–∞—è)**: –ø–æ–ª—É—á–µ–Ω–∞ –∫–∞–∫ ZIP; auto‚Äë–∞—É–¥–∏—Ç: –µ—Å—Ç—å asyncpg, –µ—Å—Ç—å SKIP LOCKED.


## –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Å–±–æ—Ä–∫–µ

1. –í–∑—è–ª **UI –∏–∑ V2** —Ü–µ–ª–∏–∫–æ–º (–∫–Ω–æ–ø–∫–∏/—Ç–µ–∫—Å—Ç—ã –Ω–µ –º–µ–Ω—è–ª).

2. –î–æ–±–∞–≤–∏–ª –º–æ–¥—É–ª—å **engine/**: `database.py` (SQLite/PG) –∏ `match_engine.py` (—á–∏—Å—Ç—ã–π, —Å –∞–Ω—Ç–∏‚Äë—Ä–µ–º–∞—Ç—á–µ–º –∏ PG `SKIP LOCKED`).

3. –°–æ–∑–¥–∞–ª **adapter** (`engine/adapter.py`), –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å—Ç–∞—Ä—ã–µ –∏–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–π (`match_user`, `get_partner_id`, `remove_from_queue`, `end_chat`), —á—Ç–æ–±—ã **–Ω–µ —Ç—Ä–æ–≥–∞—Ç—å –≤–∞—à UI‚Äë–∫–æ–¥**.

4. –û–±–Ω–æ–≤–∏–ª `requirements.txt` –∏ `docker-compose.yml` (–ø–æ—Ä—Ç 5433, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å –≤–∞—à–∏–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º).


## –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –ø–∞—Ç—á–∏

- –ù–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω –∏–º–ø–æ—Ä—Ç match_*.py –≤ bot_2.py ‚Äî –æ—Å—Ç–∞–≤–∏–ª –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.


## –ß—Ç–æ —É–¥–∞–ª–∏—Ç—å –∫–∞–∫ –ª–∏—à–Ω–µ–µ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

- –°—Ç–∞—Ä—ã–µ `match_sqlite.py` / `match_pg.py` (–µ—Å–ª–∏ –æ—Å—Ç–∞–ª–∏—Å—å) ‚Äî —Ç–µ–ø–µ—Ä—å –∏—Ö –∑–∞–º–µ–Ω—è–µ—Ç `engine/`.

- –î—É–±–ª–∏–∫–∞—Ç—ã –±–∞–∑ (`*.db`, `*.sqlite*`) –∏–∑ –∫–æ—Ä–Ω—è/–ø–æ–¥–ø–∞–ø–æ–∫.

- –ù–µ–≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã–µ —á–µ—Ä–Ω–æ–≤—ã–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã/—Ç–µ—Å—Ç—ã (–ø–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—é).


## –ß–µ–∫‚Äë–ª–∏—Å—Ç –ø—Ä–∏—ë–º–∫–∏

1. `/start` ‚Üí –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∏ –∫–ª–∞–≤–∏—à–∏ *–∫–∞–∫ –≤ V2*.

2. ¬´–ü–æ–∏—Å–∫‚Ä¶¬ª ‚Üí ¬´–ò–¥—ë—Ç –ø–æ–∏—Å–∫‚Ä¶¬ª; –ø—Ä–∏ –≤—Ç–æ—Ä–æ–º –∫–ª–∏–µ–Ω—Ç–µ: **¬´üåü –°–æ–±–µ—Å–µ–¥–Ω–∏–∫ –Ω–∞–π–¥–µ–Ω!¬ª** –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –¥–∏–∞–ª–æ–≥–∞.

3. **–ê–Ω—Ç–∏‚Äë—Ä–µ–º–∞—Ç—á**: –ø–æ–≤—Ç–æ—Ä–Ω–∞—è —Å–≤–æ–¥–∫–∞ —Ç–æ–π –∂–µ –ø–∞—Ä—ã –Ω–µ —Ä–∞–Ω—å—à–µ, —á–µ–º —á–µ—Ä–µ–∑ 30 –º–∏–Ω.

4. –°–∫—Ä—ã—Ç–∏–µ ¬´üîí –ü—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–∂–∏–º¬ª –¥–ª—è `<18` (–∫–∞–∫ –≤ –≤–∞—à–µ–º UI‚Äë–∫–æ–¥–µ).

5. `/privacy` –∏ `/forgetme` —Ä–∞–±–æ—Ç–∞—é—Ç; TTL‚Äë–æ—á–∏—Å—Ç–∫–∞ –º–µ–¥–∏–∞ –∫—Ä—É—Ç–∏—Ç—Å—è –≤ —Ñ–æ–Ω–µ (–µ—Å–ª–∏ –±—ã–ª–∞ –≤ V2).

6. **Docker/PG**: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è (`docker compose up -d`), –±–æ—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è via `PG_DSN` –Ω–∞ `localhost:5433`.


## –ö–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞

**SQLite**:
```
pip install -r requirements.txt
copy .env.example .env  # –∑–∞–ø–æ–ª–Ω–∏ TOKEN
set USE_POSTGRES=0  # –∏–ª–∏ –≤ .env
python bot_2.py
```

**Postgres/Docker**:
```
docker compose up -d
pip install -r requirements.txt
copy .env.example .env  # –∑–∞–ø–æ–ª–Ω–∏ TOKEN
set USE_POSTGRES=1  # –∏–ª–∏ –≤ .env
python bot_2.py
```
